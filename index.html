<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Nosso Planner de Viagem ‚ú®</title>
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root { --primary: #6366f1; --bg: #f8fafc; --card: #ffffff; }
    body { font-family: 'Inter', sans-serif; background: var(--bg); margin: 0; color: #1e293b; }
    header { padding: 40px 20px; text-align: center; background: white; border-bottom: 1px solid #e2e8f0; }
    header h1 { margin: 0; font-size: 1.8rem; color: var(--primary); }
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; padding: 20px; max-width: 1200px; margin: 0 auto; }
    .card { background: var(--card); border-radius: 16px; overflow: hidden; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); transition: 0.3s; cursor: pointer; }
    .card:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); }
    .card img { width: 100%; height: 180px; object-fit: cover; }
    .card-info { padding: 15px; }
    .card h3 { margin: 0; font-size: 1rem; color: #334155; }
    dialog { width: 90%; max-width: 500px; border: none; border-radius: 20px; padding: 25px; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25); }
    dialog::backdrop { background: rgba(15, 23, 42, 0.5); backdrop-filter: blur(4px); }
    textarea { width: 100%; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px; margin: 8px 0; box-sizing: border-box; }
    .task-input-group { display: flex; gap: 8px; margin: 8px 0 15px 0; }
    input[type="text"] { flex: 1; padding: 10px; border: 1px solid #e2e8f0; border-radius: 8px; }
    .tasks-list { list-style: none; padding: 0; }
    .tasks-list li { background: #f1f5f9; padding: 10px; border-radius: 8px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; }
    button { cursor: pointer; border: none; border-radius: 8px; padding: 10px 15px; font-weight: 600; }
    .btn-save { background: #10b981; color: white; width: 100%; margin-top: 20px; }
    .btn-close { background: #f1f5f9; color: #64748b; width: 100%; margin-top: 10px; }
    .btn-del { color: #ef4444; background: none; font-size: 1.2rem; }
  </style>
</head>
<body>

<header>
  <h1>‚úàÔ∏è Planner de Viagem</h1>
  <p>Toque em um dia para planejar</p>
</header>

<section class="grid" id="calendar"></section>

<dialog id="modal">
  <h3 id="modalTitle" style="color: var(--primary);"></h3>
  <label>üìù Anota√ß√µes:</label>
  <textarea id="notes" rows="4"></textarea>
  <label>‚úÖ Checklist:</label>
  <div class="task-input-group">
    <input type="text" id="newTask" placeholder="Nova tarefa...">
    <button style="background:var(--primary);color:white" onclick="addTask()">+</button>
  </div>
  <ul class="tasks-list" id="taskList"></ul>
  <button class="btn-save" onclick="saveDay()">Gravar Altera√ß√µes</button>
  <button class="btn-close" onclick="modal.close()">Voltar</button>
</dialog>

<script>
const supabaseClient = supabase.createClient(
  'https://bxsbxxikhxpdijzymnxd.supabase.co', 
  'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ4c2J4eGlraHhwZGlqenltbnhkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgzMTA2MjgsImV4cCI6MjA4Mzg4NjYyOH0._ohhIGle2Colw3n7liCQfhm_fDclmGdWN6B2K_ymapA'
);

const days = [
  {id:1, title:'Dia 1 SEG‚Äì GRU-DFW: A Jornada 07/09', img:'https://images.unsplash.com/photo-1569154941061-e231b4725ef1?w=400'},
  {id:2, title:'Dia 2 TER‚Äì Texas 08/09', img:'https://images.unsplash.com/photo-1545345540-ea5d968030af?w=400'},
  {id:3, title:'Dia 3 QUA‚Äì Explorando Texas 09/09', img:'https://images.unsplash.com/photo-1623620893978-aa52349a1d7e?w=400'},
  {id:4, title:'Dia 4 QUI‚Äì M√∫sica & Sabor 10/09', img:'https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=400'},
  {id:5, title:'Dia 5 SEX‚Äì Vida no Texas 11/09', img:'https://plus.unsplash.com/premium_photo-1673995014030-87cbf03c395b?w=400'},
  {id:6, title:'Dia 6 SAB‚Äì Texas para Orlando 12/09', img:'https://images.unsplash.com/photo-1436491865332-7a61a109cc05?w=400'},
  {id:7, title:'Dia 7 DOM‚Äì Dia Livre 13/09', img:'https://images.unsplash.com/photo-1617409123168-8fb039dd3b39?w=400'},
  {id:8, title:'Dia 8 SEG‚Äì Magic Kingdom 14/09', img:'https://images.unsplash.com/photo-1597466599360-3b9775841aec?w=400'},
  {id:9, title:'Dia 9 TER‚Äì Animal Kingdom 15/09', img:'https://images.unsplash.com/photo-1547721064-da6cfb341d50?w=400'},
  {id:10, title:'Dia 10 QUAR-‚Äì Dia Livre 16/09', img:'https://images.unsplash.com/photo-1483985988355-763728e1935b?w=400'},
  {id:11, title:'Dia 11 QUI‚Äì Hollywood Studios 17/09', img:'https://images.unsplash.com/photo-1620080675071-33567c36c25c?w=400'},
  {id:12, title:'Dia 12 SEX‚Äì Epcot 18/09', img:'https://images.unsplash.com/photo-1616897390105-0d9fc21a0745?w=400'},
  {id:13, title:'Dia 13 SAB‚Äì Dia Livre 19/09', img:'https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=400'},
  {id:14, title:'Dia 14 DOM‚Äì SeaWorld 20/09', img:'https://images.unsplash.com/photo-1570481662006-a3a1374699e8?w=400'},
  {id:15, title:'Dia 15 SEG‚Äì Epic Universo 21/09', img:'https://images.unsplash.com/photo-1763716575502-4525599bcdaa?w=400'},
  {id:16, title:'Dia 16 TER‚Äì Dia Livre 22/09', img:'https://images.unsplash.com/photo-1609184889514-656548112551?w=400'},
  {id:17, title:'Dia 17 QUAR‚Äì Universal Studios 23/09', img:'https://images.unsplash.com/photo-1618945372420-2470ece5277c?w=400'},
  {id:18, title:'Dia 18 QUI‚Äì Islands of Adventure 24/09', img:'https://images.unsplash.com/photo-1712677673451-9274bd6b1f13?w=400'},
  {id:19, title:'Dia 19 SEX‚Äì Dia Livre 25/09', img:'https://images.unsplash.com/photo-1555529669-e69e7aa0ba9a?w=400'},
  {id:20, title:'Dia 20 SAB‚Äì Repetir Parque Favorito 26/09', img:'https://images.unsplash.com/photo-1616262373426-18bfa28bafab?w=400'},
  {id:21, title:'Dia 21 DOM‚Äì Retorno & Celebra√ß√£o 27/09', img:'https://images.unsplash.com/photo-1530521954074-e64f6810b32d?w=400'}
];

const calendar = document.getElementById('calendar');
const modal = document.getElementById('modal');
const taskListUI = document.getElementById('taskList');
let currentDayId = null;

days.forEach(day => {
  const card = document.createElement('div');
  card.className = 'card';
  card.innerHTML = `<img src="${day.img}"><div class="card-info"><h3>${day.title}</h3></div>`;
  card.onclick = () => openDay(day);
  calendar.appendChild(card);
});

async function openDay(day) {
  currentDayId = day.id;
  document.getElementById('modalTitle').innerText = day.title;
  taskListUI.innerHTML = '';
  document.getElementById('notes').value = 'Carregando...';

  const { data } = await supabaseClient.from('planner_days').select('*').eq('id', day.id).single();
  document.getElementById('notes').value = data?.notes || '';
  if (data?.tasks) JSON.parse(data.tasks).forEach(t => renderTask(t));
  modal.showModal();
}

function renderTask(text) {
  const li = document.createElement('li');
  li.innerHTML = `<span>${text}</span> <button class="btn-del" onclick="this.parentElement.remove()">√ó</button>`;
  taskListUI.appendChild(li);
}

function addTask() {
  const input = document.getElementById('newTask');
  if(input.value) renderTask(input.value);
  input.value = '';
}

async function saveDay() {
  const notes = document.getElementById('notes').value;
  const tasksArray = Array.from(document.querySelectorAll('#taskList li span')).map(s => s.innerText);
  await supabaseClient.from('planner_days').upsert({ id: currentDayId, notes, tasks: JSON.stringify(tasksArray) });
  modal.close();
}
</script>
</body>
</html>